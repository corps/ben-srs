(()=>{"use strict";var e,t,r={4213:(e,t,r)=>{function n(e){return[e]}function a(e){return null==e?null:[e]}function o(e,t){return function(e){return null!=e}(e)?[t(e[0])]:null}function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=f(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw o}}}}function u(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e,t){for(var r=0;r<e.length&&r<t.length;++r){var n=e[r],a=t[r];if(n!==a)return a===1/0?-1:n===1/0?1:null==n?-1:null==a?1:n<a?-1:1}return e.length===t.length?0:e.length>t.length?1:-1}function y(e,t,r){for(var n,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.length;a<o;)r(t,e[n=a+o>>>1])>0?a=n+1:o=n;return a}r(5666);var v=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};p(this,e),this.mainIndexName=t,this.indexKeyers=r,this.indexDependentGroup=n,this.indexGroupKeyers=a,this.indexReducers=o}var t,r,a;return t=e,a=[{key:"iterator",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=e.getRangeFrom(t,r,a),i=o.startIdx,u=o.endIdx,s=i;return function(){return s<u?n(t[1][s++]):null}}},{key:"reverseIter",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;r&&(r=m(r)),a&&(a=m(a));var o=e.getRangeFrom(t,a,r),i=o.startIdx,u=o.endIdx,s=u;return function(){return s>i?n(t[1][--s]):null}}},{key:"getAllMatching",value:function(t,r){var n=e.getRangeFrom(t,r,w(r)),a=n.startIdx,o=n.endIdx;return t[1].slice(a,o)}},{key:"getRangeFrom",value:function(e){var t=l(e,1),r=t[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{startIdx:null==n?0:y(r,n,b),endIdx:null==a?r.length:y(r,a,b)}}},{key:"getFirstMatching",value:function(t,r){return e.iterator(t,r,w(r))()}}],(r=[{key:"setKeyer",value:function(e,t){this.indexKeyers[e]=t}},{key:"addGroupedIndex",value:function(e,t,r,n,a){if(!this.indexKeyers[r])throw new Error("Dependent index "+r+" should be defined before "+e);this.setKeyer(e,t),this.indexDependentGroup[e]=r,this.indexGroupKeyers[e]=n,this.indexReducers[e]=a}},{key:"empty",value:function(){var e={};for(var t in this.indexKeyers)e[t]=[[],[]];return e}},{key:"removeAll",value:function(e,t){return this.splice(e,t,[])}},{key:"removeByPk",value:function(t,r){return this.removeAll(t,e.getAllMatching(t[this.mainIndexName],r))}},{key:"update",value:function(t,r){var n=this,a=[],i=[],u=l(g(this.indexKeyers[this.mainIndexName],r),2),s=u[0];return u[1].forEach((function(r,u){o(e.getFirstMatching(t[n.mainIndexName],s[u]),(function(e){return a.push(e)})),i.push(r)})),this.splice(t,a,i)}},{key:"splice",value:function(t,r,n){var a=this,l=t;if(!r.length&&!n.length)return t;t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t);for(var f=function(){var s=p[d],c=t[s],f=r,h=n,b=a.indexDependentGroup[s];if(b){var y=a.indexGroupKeyers[s],v=a.indexReducers[s],m=g(y,[].concat(u(f),u(h)));f=[],h=[];var x,k=i(m[0]);try{for(k.s();!(x=k.n()).done;){var O=x.value,I=l[b],j=w(O),A=e.iterator(I,O,j),R=e.reverseIter(I,j,O),P=v(A,R),S=t[b],z=v(A=e.iterator(S,O,j),R=e.reverseIter(S,j,O));P!==z&&(o(P,(function(e){return f.push(e)})),o(z,(function(e){return h.push(e)})))}}catch(e){k.e(e)}finally{k.f()}}if(!h.length&&!f.length)return"continue";c=t[s]=[u(c[0]),u(c[1])];var M,D=i(f);try{for(D.s();!(M=D.n()).done;){var K=M.value;a.removeFromIndex(c,s,K)}}catch(e){D.e(e)}finally{D.f()}var E,N=i(h);try{for(N.s();!(E=N.n()).done;){var C=E.value;a.addToIndex(c,s,C)}}catch(e){N.e(e)}finally{N.f()}},d=0,p=Object.keys(this.indexKeyers);d<p.length;d++)f();return t}},{key:"strictValueKeyOf",value:function(e,t){var r=this.indexKeyers[this.mainIndexName](t);return e===this.mainIndexName?r:[].concat(u(this.indexKeyers[e](t)),u(r))}},{key:"addToIndex",value:function(t,r,n){var a=this.strictValueKeyOf(r,n),o=e.getRangeFrom(t,a).startIdx;t[0].splice(o,0,a),t[1].splice(o,0,n)}},{key:"removeFromIndex",value:function(t,r,n){var a=this.strictValueKeyOf(r,n),o=e.getRangeFrom(t,a,m(a)),i=o.startIdx,u=o.endIdx;t[0].splice(i,u-i),t[1].splice(i,u-i)}}])&&h(t.prototype,r),a&&h(t,a),e}();function g(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[],[]],a=i(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,u=e(o),s=v.getRangeFrom(n,u,m(u)),c=s.startIdx,l=s.endIdx;n[0].splice(c,l-c,u),n[1].splice(c,l-c,o)}}catch(e){a.e(e)}finally{a.f()}return n}function m(e){return[].concat(u(e),[null])}function w(e){return[].concat(u(e),[1/0])}function x(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||k(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){if(e){if("string"==typeof e)return O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,t):void 0}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var R={attributes:{content:"This would be new note",language:"",editsComplete:!1,terms:void 0,audioFileId:null},id:"",path:"",version:""},P=j(j({},R),{},{attributes:j(j({},R.attributes),{},{terms:[]}),id:void 0,path:void 0,version:void 0}),S={noteId:"",language:"",attributes:{reference:"",marker:"",pronounce:"",definition:"",hint:"",clozes:void 0}},z=(j(j({},S),{},{attributes:j(j({},S.attributes),{},{clozes:[]}),noteId:void 0,language:void 0}),{noteId:"",reference:"",marker:"",clozeIdx:-1,language:"",attributes:{type:"produce",clozed:"",schedule:{lastAnsweredMinutes:0,nextDueMinutes:0,delayIntervalMinutes:0,intervalMinutes:0,isNew:!0}}}),M=(j(j({},z),{},{attributes:j(j({},z.attributes),{},{answers:[]}),noteId:void 0,reference:void 0,marker:void 0,clozeIdx:void 0,language:void 0}),"\n===\n");function D(e){var t=j({},P);t.attributes=j({},P.attributes);var r=e.lastIndexOf(M);return-1!==r?(t.attributes=JSON.parse(e.slice(r+M.length)),t.attributes.content=e.slice(0,r)):t.attributes.content=e,t}var K=new v("byPath");K.setKeyer("byPath",(function(e){return e.path.split("/")})),K.setKeyer("byId",(function(e){return[e.id]})),K.setKeyer("byLanguage",(function(e){return[e.attributes.language]})),K.setKeyer("byAudioFileId",(function(e){return[e.attributes.audioFileId]})),K.setKeyer("byEditsComplete",(function(e){return[e.attributes.editsComplete]}));var E=new v("byNoteIdReferenceAndMarker");E.setKeyer("byNoteIdReferenceAndMarker",(function(e){return[e.noteId,e.attributes.reference,e.attributes.marker]})),E.setKeyer("byLanguage",(function(e){return[e.language]}));var N=new v("byNoteIdReferenceMarkerAndClozeIdx");N.setKeyer("byNoteIdReferenceMarkerAndClozeIdx",(function(e){return[e.noteId,e.reference,e.marker,e.clozeIdx]})),N.setKeyer("byLanguageSpokenAndNextDue",(function(e){return[e.language,"listen"==e.attributes.type||"speak"==e.attributes.type,!e.attributes.schedule.delayIntervalMinutes,e.attributes.schedule.nextDueMinutes]})),N.setKeyer("byLanguageSpokenNewAndNextDue",(function(e){return[e.language,"listen"==e.attributes.type||"speak"==e.attributes.type,e.attributes.schedule.isNew,!e.attributes.schedule.delayIntervalMinutes,e.attributes.schedule.nextDueMinutes]})),N.setKeyer("byNextDue",(function(e){return[!e.attributes.schedule.delayIntervalMinutes,e.attributes.schedule.nextDueMinutes]}));var C=new v("byNoteIdReferenceMarkerClozeIdxAndAnswerIdx");function F(e,t,r,n){var a,o=j(j({},e),{},{attributes:j(j({},e.attributes),{},{terms:void 0}),id:t,path:r,version:n}),i=[],u=[],s=[],c={note:o,terms:i,clozes:u,clozeAnswers:s},l=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=k(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw o}}}}(e.attributes.terms);try{for(l.s();!(a=l.n()).done;){var f=a.value,d=j(j({},f),{},{attributes:j(j({},f.attributes),{},{clozes:void 0}),language:o.attributes.language,noteId:o.id});i.push(d);for(var p=0;p<f.attributes.clozes.length;++p){var h=f.attributes.clozes[p],b=j(j({},h),{},{clozeIdx:p,marker:d.attributes.marker,reference:d.attributes.reference,language:o.attributes.language,noteId:o.id});u.push(b);for(var y=0;y<h.attributes.answers.length;++y){var v={answer:h.attributes.answers[y],answerIdx:y,clozeIdx:p,marker:d.attributes.marker,reference:d.attributes.reference,language:o.attributes.language,noteId:o.id};s.push(v)}}}}catch(e){l.e(e)}finally{l.f()}return c}C.setKeyer("byNoteIdReferenceMarkerClozeIdxAndAnswerIdx",(function(e){return[e.noteId,e.reference,e.marker,e.clozeIdx,e.answerIdx>0?1:0]})),C.setKeyer("byLanguageAndAnswered",(function(e){return[e.language,e.answer[0]]})),C.addGroupedIndex("byFirstAnsweredOfNoteIdReferenceMarkerAndClozeIdx",(function(e){return[e.answer[0]]}),"byNoteIdReferenceMarkerClozeIdxAndAnswerIdx",(function(e){return[e.noteId,e.reference,e.marker,e.clozeIdx]}),(function(e,t){return e()})),C.addGroupedIndex("byLastAnsweredOfNoteIdReferenceMarkerAndClozeIdx",(function(e){return[e.answer[0]]}),"byNoteIdReferenceMarkerClozeIdxAndAnswerIdx",(function(e){return[e.noteId,e.reference,e.marker,e.clozeIdx]}),(function(e,t){return t()}));var T={notes:K.empty(),terms:E.empty(),clozes:N.empty(),clozeAnswers:C.empty()};function B(e){for(var t=[],r=[],n=[],a=[],o=arguments.length,i=new Array(o>1?o-1:0),u=1;u<o;u++)i[u-1]=arguments[u];for(var s=0,c=i;s<c.length;s++){var l=c[s];t.push(l.note),r.push.apply(r,x(l.terms)),n.push.apply(n,x(l.clozes)),a.push.apply(a,x(l.clozeAnswers))}e.notes=K.update(e.notes,t),e.terms=E.update(e.terms,r),e.clozes=N.update(e.clozes,n),e.clozeAnswers=C.update(e.clozeAnswers,a)}function G(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function q(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){G(o,n,a,i,u,"next",e)}function u(e){G(o,n,a,i,u,"throw",e)}i(void 0)}))}}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $(e,t,r){return t&&L(e.prototype,t),r&&L(e,r),e}function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var J=function e(){var t=this;U(this,e),V(this,"resolve",(function(){return null})),V(this,"reject",(function(){return null})),V(this,"promise",new Promise((function(e,r){t.resolve=e,t.reject=r})))},H=function(){function e(){U(this,e),V(this,"trigger",new J),V(this,"closed",!1)}var t;return $(e,[{key:"send",value:function(e){this.closed||(this.trigger.resolve(e),this.trigger=new J)}},{key:"reject",value:function(e){this.closed||(this.trigger.reject(e),this.trigger=new J)}},{key:"receive",value:(t=q(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.trigger.promise;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(e){this.trigger.resolve(e),this.closed=!0}}]),e}(),Q=function(){function e(){U(this,e),V(this,"channel",new H),V(this,"open",!0)}var t;return $(e,[{key:"ready",value:(t=q(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.open){e.next=11;break}return this.open=!1,e.prev=3,e.next=6,t();case 6:return e.abrupt("return",e.sent);case 7:return e.prev=7,this.channel.send(),this.open=!0,e.finish(7);case 11:return e.next=13,this.channel.receive();case 13:e.next=0;break;case 15:case"end":return e.stop()}}),e,this,[[3,,7,11]])}))),function(e){return t.apply(this,arguments)})}]),e}();function W(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function X(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){W(o,n,a,i,u,"next",e)}function u(e){W(o,n,a,i,u,"throw",e)}i(void 0)}))}}function Y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){ee(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function te(e){return new Promise((function(t,r){var n=new FileReader;n.onload=function(){return t(n.result)},n.onerror=r,n.readAsText(e)}))}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){oe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ie(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function ue(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){ie(o,n,a,i,u,"next",e)}function u(e){ie(o,n,a,i,u,"throw",e)}i(void 0)}))}}_(_(_({},{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",opus:"audio/opus"}),{text:"text/plain; charset=UTF-8"}),{mp4:"video/mp4",ogg:"video/ogg"});var se=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ee(this,"writeSemaphore",new Q),this.db=t,this.db.version(2).stores({cursors:"&backend",metadata:"&id,path,dirty,ext",blobs:"&id,path,ext,dirty"})}var t,r,o,i,u,s,c,l,f,d,p,h,b;return t=e,(r=[{key:"markDeleted",value:(b=X(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db.table("metadata").where("id").equals(t).first();case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return");case 5:return r=_(_({},r),{},{dirty:1,updatedAt:Date.now(),deleted:!0}),e.next=8,this.storeBlobAndMetadata(r,new Blob);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"fetchDirty",value:function(){return this.db.table("blobs").where("dirty").equals(1).toArray()}},{key:"allKeys",value:(h=X(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.db.table("metadata").toCollection().keys());case 1:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"clear",value:(p=X(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.writeSemaphore.ready(X(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.db.table("metadata").clear();case 2:return e.next=4,t.db.table("blobs").clear();case 4:return e.next=6,t.db.table("cursors").clear();case 6:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"storeCursor",value:(d=X(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.writeSemaphore.ready(X(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.db.table("cursors").put({backend:"default",cursor:t});case 2:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"getCursor",value:(f=X(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db.table("cursors").where("backend").equals("default").first();case 2:return t=e.sent,e.abrupt("return",(null==t?void 0:t.cursor)||"");case 4:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"storeBlob",value:(l=X(regeneratorRuntime.mark((function e(t,r,a){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=r.path,s=void 0,c=(s=u.split(".")).length>0?n(s[s.length-1]):null,"",o=null==c?"":c[0],i=_(_({},r),{},{ext:o,dirty:a?1:0,updatedAt:Date.now()}),e.next=4,this.storeBlobAndMetadata(i,t);case 4:case"end":return e.stop()}var u,s,c}),e,this)}))),function(e,t,r){return l.apply(this,arguments)})},{key:"storeBlobAndMetadata",value:(c=X(regeneratorRuntime.mark((function e(t,r){var n,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=_(_({},t),{},{blob:r}),e.next=3,this.writeSemaphore.ready(X(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.db.transaction("rw!","metadata","blobs",X(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.db.table("metadata").put(t);case 2:return e.next=4,a.db.table("blobs").put(n);case 4:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"deletePath",value:(s=X(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.writeSemaphore.ready(X(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.db.transaction("rw!","metadata","blobs",X(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.db.table("metadata").where("path").between(t,t+"￾",!0,!1).delete();case 2:return e.next=4,r.db.table("blobs").where("path").between(t,t+"￾",!0,!1).delete();case 4:return e.next=6,r.db.table("metadata").where("path").equalsIgnoreCase(t).delete();case 6:return e.next=8,r.db.table("blobs").where("path").equalsIgnoreCase(t).delete();case 8:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"fetchBlob",value:(u=X(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.db.table("blobs").where("id").equals(t).first().then(a));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"fetchBlobsByExt",value:(i=X(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.db.table("blobs").where("ext").equals(t).toArray());case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"fetchMetadataByExts",value:(o=X(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.db.table("metadata").where("ext").anyOf(t).toArray());case 1:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})}])&&Y(t.prototype,r),e}())(new(r(9642).default)("benSrsNew")),ce=self;ce.onmessage=ue(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=ae({},T),e.next=4,se.fetchBlobsByExt("txt");case 4:return r=e.sent,e.next=7,Promise.all(r.map(function(){var e=ue(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.blob,n=t.id,a=t.rev,o=t.path,e.next=3,te(r);case 3:return i=e.sent,u=D(i),e.abrupt("return",F(u,n,o,a));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:n=e.sent,B.apply(void 0,[t].concat(function(e){if(Array.isArray(e))return re(e)}(a=n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||function(e,t){if(e){if("string"==typeof e)return re(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?re(e,t):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),ce.postMessage({indexes:t}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:case"end":return e.stop()}var a}),e,null,[[0,12]])})))}},n={};function a(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={exports:{}};return r[e](o,o.exports,a),o.exports}a.m=r,a.x=()=>{var e=a.O(void 0,[160],(()=>a(4213)));return a.O(e)},e=[],a.O=(t,r,n,o)=>{if(!r){var i=1/0;for(c=0;c<e.length;c++){for(var[r,n,o]=e[c],u=!0,s=0;s<r.length;s++)(!1&o||i>=o)&&Object.keys(a.O).every((e=>a.O[e](r[s])))?r.splice(s--,1):(u=!1,o<i&&(i=o));u&&(e.splice(c--,1),t=n())}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[r,n,o]},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,r)=>(a.f[r](e,t),t)),[])),a.u=e=>e+".js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e={213:1};a.f.i=(t,r)=>{e[t]||importScripts(a.p+a.u(t))};var t=self.webpackChunk=self.webpackChunk||[],r=t.push.bind(t);t.push=t=>{var[n,o,i]=t;for(var u in o)a.o(o,u)&&(a.m[u]=o[u]);for(i&&i(a);n.length;)e[n.pop()]=1;r(t)}})(),t=a.x,a.x=()=>a.e(160).then(t),a.x()})();