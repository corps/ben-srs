(()=>{"use strict";var e,t,r={4388:(e,t,r)=>{function n(e){return[e]}function o(e,t){return function(e){return null!=e}(e)?[t(e[0])]:null}function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=c(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function i(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){for(var r=0;r<e.length&&r<t.length;++r){var n=e[r],o=t[r];if(n!==o)return o===1/0?-1:n===1/0?1:null==n?-1:null==o?1:n<o?-1:1}return e.length===t.length?0:e.length>t.length?1:-1}function b(e,t,r){for(var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.length;o<a;)r(t,e[n=o+a>>>1])>0?o=n+1:a=n;return o}r(5666);var v=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};d(this,e),this.mainIndexName=t,this.indexKeyers=r,this.indexDependentGroup=n,this.indexGroupKeyers=o,this.indexReducers=a}var t,r,c;return t=e,c=[{key:"iterator",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=e.getRangeFrom(t,r,o),i=a.startIdx,u=a.endIdx,l=i;return function(){return l<u?n(t[1][l++]):null}}},{key:"reverseIter",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;r&&(r=g(r)),o&&(o=g(o));var a=e.getRangeFrom(t,o,r),i=a.startIdx,u=a.endIdx,l=u;return function(){return l>i?n(t[1][--l]):null}}},{key:"getAllMatching",value:function(t,r){var n=e.getRangeFrom(t,r,m(r)),o=n.startIdx,a=n.endIdx;return t[1].slice(o,a)}},{key:"getRangeFrom",value:function(e){var t=s(e,1),r=t[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{startIdx:null==n?0:b(r,n,p),endIdx:null==o?r.length:b(r,o,p)}}},{key:"getFirstMatching",value:function(t,r){return e.iterator(t,r,m(r))()}}],(r=[{key:"setKeyer",value:function(e,t){this.indexKeyers[e]=t}},{key:"addGroupedIndex",value:function(e,t,r,n,o){if(!this.indexKeyers[r])throw new Error("Dependent index "+r+" should be defined before "+e);this.setKeyer(e,t),this.indexDependentGroup[e]=r,this.indexGroupKeyers[e]=n,this.indexReducers[e]=o}},{key:"empty",value:function(){var e={};for(var t in this.indexKeyers)e[t]=[[],[]];return e}},{key:"removeAll",value:function(e,t){return this.splice(e,t,[])}},{key:"removeByPk",value:function(t,r){return this.removeAll(t,e.getAllMatching(t[this.mainIndexName],r))}},{key:"update",value:function(t,r){var n=this,a=[],i=[],u=s(h(this.indexKeyers[this.mainIndexName],r),2),l=u[0];return u[1].forEach((function(r,u){o(e.getFirstMatching(t[n.mainIndexName],l[u]),(function(e){return a.push(e)})),i.push(r)})),this.splice(t,a,i)}},{key:"splice",value:function(t,r,n){var s=this,c=t;if(!r.length&&!n.length)return t;t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t);for(var f=function(){var u=y[d],l=t[u],f=r,p=n,b=s.indexDependentGroup[u];if(b){var v=s.indexGroupKeyers[u],g=s.indexReducers[u],I=h(v,[].concat(i(f),i(p)));f=[],p=[];var w,x=a(I[0]);try{for(x.s();!(w=x.n()).done;){var O=w.value,A=c[b],j=m(O),k=e.iterator(A,O,j),P=e.reverseIter(A,j,O),S=g(k,P),z=t[b],K=g(k=e.iterator(z,O,j),P=e.reverseIter(z,j,O));S!==K&&(o(S,(function(e){return f.push(e)})),o(K,(function(e){return p.push(e)})))}}catch(e){x.e(e)}finally{x.f()}}if(!p.length&&!f.length)return"continue";l=t[u]=[i(l[0]),i(l[1])];var M,N=a(f);try{for(N.s();!(M=N.n()).done;){var D=M.value;s.removeFromIndex(l,u,D)}}catch(e){N.e(e)}finally{N.f()}var R,E=a(p);try{for(E.s();!(R=E.n()).done;){var C=R.value;s.addToIndex(l,u,C)}}catch(e){E.e(e)}finally{E.f()}},d=0,y=Object.keys(this.indexKeyers);d<y.length;d++)f();return t}},{key:"strictValueKeyOf",value:function(e,t){var r=this.indexKeyers[this.mainIndexName](t);return e===this.mainIndexName?r:[].concat(i(this.indexKeyers[e](t)),i(r))}},{key:"addToIndex",value:function(t,r,n){var o=this.strictValueKeyOf(r,n),a=e.getRangeFrom(t,o).startIdx;t[0].splice(a,0,o),t[1].splice(a,0,n)}},{key:"removeFromIndex",value:function(t,r,n){var o=this.strictValueKeyOf(r,n),a=e.getRangeFrom(t,o,g(o)),i=a.startIdx,u=a.endIdx;t[0].splice(i,u-i),t[1].splice(i,u-i)}}])&&y(t.prototype,r),c&&y(t,c),e}();function h(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[],[]],o=a(t);try{for(o.s();!(r=o.n()).done;){var i=r.value,u=e(i),l=v.getRangeFrom(n,u,g(u)),s=l.startIdx,c=l.endIdx;n[0].splice(s,c-s,u),n[1].splice(s,c-s,i)}}catch(e){o.e(e)}finally{o.f()}return n}function g(e){return[].concat(i(e),[null])}function m(e){return[].concat(i(e),[1/0])}function I(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||w(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){if(e){if("string"==typeof e)return x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(e,t):void 0}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){j(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var k={attributes:{content:"This would be new note",language:"",editsComplete:!1,terms:void 0,audioFileId:null},id:"",path:"",version:""},P=A(A({},k),{},{attributes:A(A({},k.attributes),{},{terms:[]}),id:void 0,path:void 0,version:void 0}),S={noteId:"",language:"",attributes:{reference:"",marker:"",pronounce:"",definition:"",hint:"",clozes:void 0}},z=(A(A({},S),{},{attributes:A(A({},S.attributes),{},{clozes:[]}),noteId:void 0,language:void 0}),{noteId:"",reference:"",marker:"",clozeIdx:-1,language:"",attributes:{type:"produce",clozed:"",schedule:{lastAnsweredMinutes:0,nextDueMinutes:0,delayIntervalMinutes:0,intervalMinutes:0,isNew:!0}}}),K=(A(A({},z),{},{attributes:A(A({},z.attributes),{},{answers:[]}),noteId:void 0,reference:void 0,marker:void 0,clozeIdx:void 0,language:void 0}),"\n===\n");function M(e){var t=A({},P);t.attributes=A({},P.attributes);var r=e.lastIndexOf(K);return-1!==r?(t.attributes=JSON.parse(e.slice(r+K.length)),t.attributes.content=e.slice(0,r)):t.attributes.content=e,t}var N=new v("byPath");N.setKeyer("byPath",(function(e){return e.path.split("/")})),N.setKeyer("byId",(function(e){return[e.id]})),N.setKeyer("byLanguage",(function(e){return[e.attributes.language]})),N.setKeyer("byAudioFileId",(function(e){return[e.attributes.audioFileId]})),N.setKeyer("byEditsComplete",(function(e){return[e.attributes.editsComplete]}));var D=new v("byNoteIdReferenceAndMarker");D.setKeyer("byNoteIdReferenceAndMarker",(function(e){return[e.noteId,e.attributes.reference,e.attributes.marker]})),D.setKeyer("byLanguage",(function(e){return[e.language]}));var R=new v("byNoteIdReferenceMarkerAndClozeIdx");R.setKeyer("byNoteIdReferenceMarkerAndClozeIdx",(function(e){return[e.noteId,e.reference,e.marker,e.clozeIdx]})),R.setKeyer("byLanguageSpokenAndNextDue",(function(e){return[e.language,"listen"==e.attributes.type||"speak"==e.attributes.type,!e.attributes.schedule.delayIntervalMinutes,e.attributes.schedule.nextDueMinutes]})),R.setKeyer("byLanguageSpokenNewAndNextDue",(function(e){return[e.language,"listen"==e.attributes.type||"speak"==e.attributes.type,e.attributes.schedule.isNew,!e.attributes.schedule.delayIntervalMinutes,e.attributes.schedule.nextDueMinutes]})),R.setKeyer("byNextDue",(function(e){return[!e.attributes.schedule.delayIntervalMinutes,e.attributes.schedule.nextDueMinutes]}));var E=new v("byNoteIdReferenceMarkerClozeIdxAndAnswerIdx");E.setKeyer("byNoteIdReferenceMarkerClozeIdxAndAnswerIdx",(function(e){return[e.noteId,e.reference,e.marker,e.clozeIdx,e.answerIdx>0?1:0]})),E.setKeyer("byLanguageAndAnswered",(function(e){return[e.language,e.answer[0]]})),E.addGroupedIndex("byFirstAnsweredOfNoteIdReferenceMarkerAndClozeIdx",(function(e){return[e.answer[0]]}),"byNoteIdReferenceMarkerClozeIdxAndAnswerIdx",(function(e){return[e.noteId,e.reference,e.marker,e.clozeIdx]}),(function(e,t){return e()})),E.addGroupedIndex("byLastAnsweredOfNoteIdReferenceMarkerAndClozeIdx",(function(e){return[e.answer[0]]}),"byNoteIdReferenceMarkerClozeIdxAndAnswerIdx",(function(e){return[e.noteId,e.reference,e.marker,e.clozeIdx]}),(function(e,t){return t()}));var C={note:k,terms:[],clozes:[],clozeAnswers:[]};function F(e,t,r,n){var o,a=A(A({},e),{},{attributes:A(A({},e.attributes),{},{terms:void 0}),id:t,path:r,version:n}),i=[],u=[],l=[],s={note:a,terms:i,clozes:u,clozeAnswers:l},c=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=w(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}(e.attributes.terms);try{for(c.s();!(o=c.n()).done;){var f=o.value,d=A(A({},f),{},{attributes:A(A({},f.attributes),{},{clozes:void 0}),language:a.attributes.language,noteId:a.id});i.push(d);for(var y=0;y<f.attributes.clozes.length;++y){var p=f.attributes.clozes[y],b=A(A({},p),{},{clozeIdx:y,marker:d.attributes.marker,reference:d.attributes.reference,language:a.attributes.language,noteId:a.id});u.push(b);for(var v=0;v<p.attributes.answers.length;++v){var h={answer:p.attributes.answers[v],answerIdx:v,clozeIdx:y,marker:d.attributes.marker,reference:d.attributes.reference,language:a.attributes.language,noteId:a.id};l.push(h)}}}}catch(e){c.e(e)}finally{c.f()}return s}var T={notes:N.empty(),terms:D.empty(),clozes:R.empty(),clozeAnswers:E.empty()};function G(e){for(var t=[],r=[],n=[],o=[],a=arguments.length,i=new Array(a>1?a-1:0),u=1;u<a;u++)i[u-1]=arguments[u];for(var l=0,s=i;l<s.length;l++){var c=s[l];t.push(c.note),r.push.apply(r,I(c.terms)),n.push.apply(n,I(c.clozes)),o.push.apply(o,I(c.clozeAnswers))}e.notes=N.update(e.notes,t),e.terms=D.update(e.terms,r),e.clozes=R.update(e.clozes,n),e.clozeAnswers=E.update(e.clozeAnswers,o)}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $(e,t,r,n,o,a,i){try{var u=e[a](i),l=u.value}catch(e){return void r(e)}u.done?t(l):Promise.resolve(l).then(n,o)}function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function U(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var V=self;V.onmessage=function(e){var t=e.data.noteBlobs,r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){U(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},T);Promise.all(t.map(function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var r,n,o,a,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.blob,n=t.id,o=t.rev,a=t.path,e.prev=1,e.next=4,r.text();case 4:return i=e.sent,u=M(i),e.abrupt("return",F(u,n,a,o));case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return",C);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){$(a,n,o,i,u,"next",e)}function u(e){$(a,n,o,i,u,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}())).then((function(e){var t;G.apply(void 0,[r].concat(function(e){if(Array.isArray(e))return L(e)}(t=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),console.log("posting back..."),V.postMessage({indexes:r})}))}}},n={};function o(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={exports:{}};return r[e](a,a.exports,o),a.exports}o.m=r,o.x=()=>{var e=o.O(void 0,[666],(()=>o(4388)));return o.O(e)},e=[],o.O=(t,r,n,a)=>{if(!r){var i=1/0;for(s=0;s<e.length;s++){for(var[r,n,a]=e[s],u=!0,l=0;l<r.length;l++)(!1&a||i>=a)&&Object.keys(o.O).every((e=>o.O[e](r[l])))?r.splice(l--,1):(u=!1,a<i&&(i=a));u&&(e.splice(s--,1),t=n())}return t}a=a||0;for(var s=e.length;s>0&&e[s-1][2]>a;s--)e[s]=e[s-1];e[s]=[r,n,a]},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,r)=>(o.f[r](e,t),t)),[])),o.u=e=>e+".js",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={388:1};o.f.i=(t,r)=>{e[t]||importScripts(o.p+o.u(t))};var t=self.webpackChunk=self.webpackChunk||[],r=t.push.bind(t);t.push=t=>{var[n,a,i]=t;for(var u in a)o.o(a,u)&&(o.m[u]=a[u]);for(i&&i(o);n.length;)e[n.pop()]=1;r(t)}})(),t=o.x,o.x=()=>o.e(666).then(t),o.x()})();